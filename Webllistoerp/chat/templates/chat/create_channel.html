{% extends 'chat/base.html' %}
{% load static %}

  {% block title %} Creative - Bootstrap Admin Template {% endblock title %}

{% block body-content %}
 <div class="container txt-center">
 	<div style="margin-left:300px; margin-top: 150px">
	   <h2>Create a Channel or Group</h2>
 		<input type="radio" id="channelid" name="channel" value="Create Channel">
  		<label for="male">Create a one to one Conversation Channel</label>
  		<input type="radio" id="groupid" name="channel" style="margin-left: 100px" value="Create Group">
  		<label for="channel" >Create a one to many Conversation Group</label>

  	<!-- Form to create a channel having one-to-one conversation -->
  	<div class="channelshow" style="background-color: white">
 	<form method="POST" id="personForm"  novalidate>
	   {% csrf_token %}
	   <h2>Create Channel</h2>
     <p id="usernmid">Admin: {{ request.user.first_name }} {{ request.user.last_name }}</p>
	  <p>
      <label for="id_usernm">Choose Member:</label>
        <select name="members" required id="id_usernm">
          <optgroup label="Director">
          {% for member in DIR %}
            <option value="{{ member.id }}" class="dropdown-item" selected>
              {{ member.first_name }} 
            {{ member.last_name }}</option>
          {% endfor %}
          </optgroup>

          <optgroup label="Cheif Technical Officer">
          {% for member in CTO %}
            <option value="{{ member.id }}" class="dropdown-item"
            selected>{{ member.first_name }} 
            {{ member.last_name }}</option>
          {% endfor %}
          </optgroup>
          
          <optgroup label="Project Manager">
          {% for member in PM %}
            <option value="{{ member.id }}" selected class="dropdown-item">
              {{ member.first_name }} 
            {{ member.last_name }}</option>
          {% endfor %}
          </optgroup>

          <optgroup label="Tech Leader">
          {% for member in TL %}
            <option value="{{ member.id }}" class="dropdown-item" selected>
              {{ member.first_name }} 
            {{ member.last_name }}</option>
          {% endfor %}
          </optgroup>

          <optgroup label="Web Developer">
          {% for member in Web %}
            <option value="{{ member.id }}" class="dropdown-item" selected>
              {{ member.first_name }} 
            {{ member.last_name }}</option>
          {% endfor %}
          <option value=" " selected>-----------</option>
          </optgroup>
        </select>
    </p>
    
    <input type="Submit" class = "btn btn-lg btn-primary" name="" value="Create"
    style="margin-left: 100px">
	</form>
	</div>

	<!-- Form to create group having one-to-many conversation -->
	<div class="groupshow" style="background-color: white">
	<form method="POST" id="personForm" novalidate>
		{% csrf_token %}
		<h2>Create Group</h2>
		<p id="usernmid">Admin: {{ request.user.first_name }} {{ request.user.last_name }}</p>
		<label for="male">Group Name : </label>
		<input type="text" name="grpname" class=""><br><br>
		<p>
  		<label for="id_child">Select Members:</label> 
  		<select name="members"  required id="id_child" multiple>
  		</select>
    </p>
    <p>
      <label for="id_usernm">Description:</label>
      <textarea id="chat-log" cols="100" name="description" rows="20"></textarea><br>
    </p>
    <input type="Submit" class = "btn btn-lg btn-primary" name="" value="Create"
    style="margin-left: 100px">
	</form>
	</div>
	</div>
 </div>

{% endblock body-content %}

{% block general-js %}
<script src="{% static 'js/scripts.js' %}"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="//code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
       $(".channelshow").hide();
       $(".groupshow").hide();

  $("#channelid").click(function(){
       $(".channelshow").toggle();
       $(".groupshow").hide();
     });

  $("#groupid").click(function(){
       $(".groupshow").toggle();
       $(".channelshow").hide();
     });

	const url = $('#personForm').attr("data-names-url");
 	const usernmId = $('#').val();

    $.ajax({
       type:  "GET",
       url : "{% url "ajax_load_channel_names" %}",
       dataType: 'json',
       success: function(data){
        var j;
        var pm = [];
        var web = [];
        var tl = [];
        var cto = [];
        for (j = 0; j < data.length; j++) {
            if (data[j]["designation"] == "Project Manager") {
                pm.push(data[j]);
            } else if (data[j]["designation"] == "Tech Leader") {
                tl.push(data[j]);
            }else if (data[j]["designation"] == "Cheif Technical Officer"){
                cto.push(data[j]);
            } else {
                web.push(data[j]);
            }
        } 

        html="<optgroup label=Cheif Technical Officer>";
        for(j = 0; j < cto.length; j++) {
          html+="<option value="+cto[j]["id"]+" name=option-value>"+cto[j]
                ["first_name"]+' '+ cto[j]["last_name"]+"</option></optgroup>"
        }
        html+="<optgroup label=Project Manager>";
        for(j = 0; j < pm.length; j++) {
          html+="<option value="+pm[j]["id"]+" name=option-value>"+pm[j]
                ["first_name"]+ ' '+ pm[j]["last_name"]+"</option></optgroup>"
        }
        html+="<optgroup label=Tech Leader>";
        for(j = 0; j < tl.length; j++) {
          html+="<option value="+tl[j]["id"]+" name=option-value>"+tl[j]
                ["first_name"]+ ' '+ tl[j]["last_name"]+"</option></optgroup>"
        }
        html+="<optgroup label=Web Developer>";
        for(j = 0; j < web.length; j++) {
          html+="<option value="+web[j]["id"]+" name=option-value>"+web[j]
                ["first_name"]+ ' '+ web[j]["last_name"]+"</option></optgroup>"
        }

        $('#id_child').html(html);
        }
    });
   
  });
</script>
{% endblock general-js %}
